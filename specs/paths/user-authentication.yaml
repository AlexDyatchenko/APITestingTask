# User Authentication Paths

v2-employee-password:
  post:
    tags:
      - Authentication
      - User Management
    summary: Change Password
    description: |
      Changes the password for the logged-in user.

      The user must provide their current password along with the new password for verification.
      The new password must meet the password complexity requirements.

      **Password Requirements** (typical):
      - Minimum 8 characters
      - Must include uppercase and lowercase letters
      - Must include at least one number
      - Must include at least one special character

      **Note**: This endpoint is typically found under the User Authentication section 
      of the Megaport API documentation.
    operationId: changePassword
    security:
      - BearerAuth: []
    requestBody:
      required: true
      content:
        application/json:
          schema:
            $ref: "../components/schemas/ChangePasswordRequest.yaml"
          example:
            currentPassword: "OldPassword123!"
            newPassword: "NewSecurePassword456!"
            confirmPassword: "NewSecurePassword456!"
    responses:
      "200":
        description: Password changed successfully
        content:
          application/json:
            schema:
              $ref: "../components/schemas/StandardResponse.yaml"
            example:
              message: "Password changed successfully"
              terms: "This data is subject to the Acceptable Use Policy https://www.megaport.com/legal/acceptable-use-policy"
      "400":
        description: Bad request - Invalid password or passwords don't match
        content:
          application/json:
            schema:
              $ref: "../components/schemas/ErrorResponse.yaml"
            examples:
              passwordMismatch:
                summary: Passwords don't match
                value:
                  message: "New password and confirmation password do not match"
                  terms: "This data is subject to the Acceptable Use Policy https://www.megaport.com/legal/acceptable-use-policy"
              weakPassword:
                summary: Password doesn't meet requirements
                value:
                  message: "Password does not meet complexity requirements"
                  terms: "This data is subject to the Acceptable Use Policy https://www.megaport.com/legal/acceptable-use-policy"
              incorrectCurrent:
                summary: Current password incorrect
                value:
                  message: "Current password is incorrect"
                  terms: "This data is subject to the Acceptable Use Policy https://www.megaport.com/legal/acceptable-use-policy"
      "401":
        $ref: "../megaport-api.yaml#/components/responses/Unauthorized"
      "500":
        $ref: "../megaport-api.yaml#/components/responses/ServerError"

v2-totp-qrcode:
  get:
    tags:
      - Multi-Factor Authentication
      - Authentication
    summary: Generate TOTP QR Code
    description: |
      Generates a TOTP (Time-based One-Time Password) secret and QR code for Multi-Factor Authentication setup.

      This endpoint is called when a user wants to enable MFA or reset their MFA device.
      The response includes:
      - A 16-character TOTP secret
      - A QR code (as image or URL) that can be scanned with authenticator apps like Google Authenticator, Authy, or Microsoft Authenticator
      - An OTP Auth URL for manual configuration

      The returned `totpSecret` should be used in the PUT `/v2/employee/{employeeId}/mfa` endpoint 
      along with a generated TOTP code to complete the MFA setup or reset process.

      **Workflow**:
      1. Call this endpoint to get the TOTP secret and QR code
      2. Scan the QR code with an authenticator app
      3. The app will generate a 6-digit code
      4. Use that code along with the secret in the MFA reset/setup endpoint

      For more information, see: https://docs.megaport.com/setting-up/enforcing-mfa/
    operationId: getTOTPQRCode
    security:
      - BearerAuth: []
    responses:
      "200":
        description: TOTP QR code generated successfully
        content:
          application/json:
            schema:
              $ref: "../components/schemas/TOTPQRCodeResponse.yaml"
            example:
              message: "QR Code generated successfully"
              terms: "This data is subject to the Acceptable Use Policy https://www.megaport.com/legal/acceptable-use-policy"
              data:
                totpSecret: "G4C3S6MBH2HSF2EV"
                qrCodeUrl: "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAA..."
                otpAuthUrl: "otpauth://totp/Megaport:user@example.com?secret=G4C3S6MBH2HSF2EV&issuer=Megaport"
      "401":
        $ref: "../megaport-api.yaml#/components/responses/Unauthorized"
      "500":
        $ref: "../megaport-api.yaml#/components/responses/ServerError"
      "503":
        $ref: "../megaport-api.yaml#/components/responses/ServiceUnavailable"
